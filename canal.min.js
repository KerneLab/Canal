/*! canal.kernelab.org v1.0.28 2018-02-26 */(function(){function a(){this.downstream=null}function b(){this.index=void 0}function c(){this.sediment=void 0}function d(){}function e(){}function f(){this.branch=void 0}function g(){this.keyR=$,this.valR=_}function h(){}function i(a){function b(){}b.prototype=new f,b.prototype.that=function(){return a},b.prototype.accept=function(a){for(var b=this.branch,c=0;c<b.length;c++)if(!this.downstream.accept([a,b[c]]))return!1;return!0},this.newPond=function(){return new b}}function j(b){function c(){}c.prototype=new a,c.prototype.accept=function(a){return!b.apply(null,a)||this.downstream.accept(a)},this.newPond=function(){return new c}}function k(a){function b(){}b.prototype=new e,b.prototype.done=function(){if(null!=this.downstream){var b=this.settle(),c=[b],d={};for(var e in b)b.hasOwnProperty(e)&&(d[e]=null);for(var f=0;f<a.length;f++){b=a[f].groupByKey().collectAsMap();for(var e in b)b.hasOwnProperty(e)&&(d[e]=null);c.push(b)}for(var g in d)if(d.hasOwnProperty(g)){for(var h=[],i=0;i<c.length;i++){var j=c[i][g];h.push(null!=j?j:[])}if(!this.downstream.accept([g,h]))break}this.downstream.done()}},this.newPond=function(){return new b}}function l(a){function b(){}a=null!=a?a:ba,b.prototype=new d,b.prototype.done=function(){if(null!=this.downstream){var b=this.settle();b.sort(a);for(var c=Y,d=null,e=0;e<b.length;e++)if(d=b[e],c===Y||0!==a(c,d)){if(!this.downstream.accept(d))break;c=d}this.downstream.done()}},this.newPond=function(){return new b}}function m(a){function c(){}c.prototype=new b,c.prototype.accept=function(b){return!a(b,this.index++)||this.downstream.accept(b)},this.newPond=function(){return new c}}function n(a){function c(){}a=null!=a?a:function(a){return a},c.prototype=new b,c.prototype.accept=function(b){var c=a(b,this.index++);if(c instanceof Array){for(var d=0;d<c.length;d++)if(!this.downstream.accept(c[d]))return!1;return!0}return this.downstream.accept(c)},this.newPond=function(){return new c}}function o(b){function c(){}c.prototype=new a,c.prototype.accept=function(a){return this.downstream.accept(ea(a,b,[]))},this.newPond=function(){return new c}}function p(a,b,c,d,e){function f(){}b=null!=b?b:$,c=null!=c?c:$,d=null!=d?d:_,e=null!=e?e:_,f.prototype=new g,f.prototype.keyOf=function(a){return b(a)},f.prototype.valOf=function(a){return d(a)},f.prototype.that=function(){return a},f.prototype.base=function(a,b){var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=null);for(var d in b)b.hasOwnProperty(d)&&(c[d]=null);return c},f.prototype.join=function(a,b,c,d){if(null!=c&&null!=d){for(var e=0;e<c.length;e++)for(var f=0;f<d.length;f++)if(!a.accept([b,[N.Some(c[e]),N.Some(d[f])]]))return!1}else if(null!=c){for(var e=0;e<c.length;e++)if(!a.accept([b,[N.Some(c[e]),N.None()]]))return!1}else if(null!=d)for(var f=0;f<d.length;f++)if(!a.accept([b,[N.None(),N.Some(d[f])]]))return!1;return!0},this.newPond=function(){var a=new f;return a.keyR=c,a.valR=e,a}}function q(a,b){function c(){}a=null!=a?a:$,b=null!=b?b:_,c.prototype=new e,c.prototype.keyOf=function(b){return a(b)},c.prototype.valOf=function(a){return b(a)},this.newPond=function(){return new c}}function r(a,b){function c(){}b=null!=b?b:ba,c.prototype=new f,c.prototype.that=function(){return a},c.prototype.accept=function(a){for(var c=this.branch,d=0;d<c.length;d++)if(0===b(a,c[d]))return this.downstream.accept(a);return!0},this.newPond=function(){return new c}}function s(a,b,c,d,e){function f(){}b=null!=b?b:$,c=null!=c?c:$,d=null!=d?d:_,e=null!=e?e:_,f.prototype=new g,f.prototype.keyOf=function(a){return b(a)},f.prototype.valOf=function(a){return d(a)},f.prototype.that=function(){return a},f.prototype.base=function(a,b){return a},f.prototype.join=function(a,b,c,d){if(null!=c&&null!=d)for(var e=0;e<c.length;e++)for(var f=0;f<d.length;f++)if(!a.accept([b,[c[e],d[f]]]))return!1;return!0},this.newPond=function(){var a=new f;return a.keyR=c,a.valR=e,a}}function t(a,b,c,d,e){function f(){}b=null!=b?b:$,c=null!=c?c:$,d=null!=d?d:_,e=null!=e?e:_,f.prototype=new g,f.prototype.keyOf=function(a){return b(a)},f.prototype.valOf=function(a){return d(a)},f.prototype.that=function(){return a},f.prototype.base=function(a,b){return a},f.prototype.join=function(a,b,c,d){if(null!=c)if(null!=d){for(var e=0;e<c.length;e++)for(var f=0;f<d.length;f++)if(!a.accept([b,[c[e],N.Some(d[f])]]))return!1}else for(var e=0;e<c.length;e++)if(!a.accept([b,[c[e],N.None()]]))return!1;return!0},this.newPond=function(){var a=new f;return a.keyR=c,a.valR=e,a}}function u(a){function c(){}c.prototype=new b,c.prototype.accept=function(b){return this.downstream.accept(a(b,this.index++))},this.newPond=function(){return new c}}function v(b){function c(){}c.prototype=new a,c.prototype.accept=function(a){var c=a[1];return this.downstream.accept(b(c[0],c[1],a[0]))},this.newPond=function(){return new c}}function w(b,c,d){function e(){}c=null!=c?c:_,d=null!=d?d:$,e.prototype=new a,e.prototype.accept=function(a){var e=d(a);return this.downstream.accept([e,b(c(a),e)])},this.newPond=function(){return new e}}function x(a){function c(){}c.prototype=new b,c.prototype.accept=function(b){return!!this.downstream.accept(b)&&(a(b,this.index++),!0)},this.newPond=function(){return new c}}function y(){function a(){}a.prototype=new d,a.prototype.done=function(){if(null!=this.downstream){for(var a=this.settle(),b=a.length-1;b>=0&&this.downstream.accept(a[b]);b--);this.downstream.done()}},this.newPond=function(){return new a}}function z(a,b,c,d,e){function f(){}b=null!=b?b:$,c=null!=c?c:$,d=null!=d?d:_,e=null!=e?e:_,f.prototype=new g,f.prototype.keyOf=function(a){return b(a)},f.prototype.valOf=function(a){return d(a)},f.prototype.that=function(){return a},f.prototype.base=function(a,b){return b},f.prototype.join=function(a,b,c,d){if(null!=d)if(null!=c){for(var e=0;e<d.length;e++)for(var f=0;f<c.length;f++)if(!a.accept([b,[N.Some(c[f]),d[e]]]))return!1}else for(var e=0;e<d.length;e++)if(!a.accept([b,[N.None(),d[e]]]))return!1;return!0},this.newPond=function(){var a=new f;return a.keyR=c,a.valR=e,a}}function A(a){function c(){}c.prototype=new b,c.prototype.accept=function(b){return this.index>=a?this.downstream.accept(b):(this.index++,!0)},this.newPond=function(){return new c}}function B(a,b){function c(){}b=null==b||b,c.prototype=new d,c.prototype.done=function(c){if(null!=this.downstream){var d=this.settle();if(null!=a?d.sort(a):d.sort(),b)for(var e=0;e<d.length&&this.downstream.accept(d[e]);e++);else for(var e=d.length-1;e>=0&&this.downstream.accept(d[e]);e--);this.downstream.done()}},this.newPond=function(){return new c}}function C(a,b){function c(){}b=null==b||b,c.prototype=new d,c.prototype.done=function(){if(null!=this.downstream){for(var c=ha(this.settle(),a,b),d=0;d<c.length&&this.downstream.accept(c[d]);d++);this.downstream.done()}},this.newPond=function(){return new c}}function D(a,b){function c(){}b=null!=b?b:ba,c.prototype=new f,c.prototype.that=function(){return a},c.prototype.accept=function(a){for(var c=!1,d=this.branch,e=0;e<d.length;e++)if(0===b(a,d[e])){c=!0;break}return!!c||this.downstream.accept(a)},this.newPond=function(){return new c}}function E(b){function c(){}c.prototype=new a,c.prototype.accept=function(a){return this.downstream.accept(a)},c.prototype.done=function(){null!=this.downstream&&(null!=b?b.converge(this.downstream):this.downstream.done())},this.newPond=function(){return new c}}function F(b){function c(){}c.prototype=new a,c.prototype.accept=function(a){return this.downstream.accept(b.apply(null,a))},this.newPond=function(){return new c}}function G(){}function H(){function a(){}a.prototype=new G,a.prototype.settling=function(){return[]},a.prototype.accept=function(a){return this.settle().push(a),!0},this.newPond=function(){return new a}}function I(a,b){function c(){}a=null!=a?a:$,b=null!=b?b:_,c.prototype=new G,c.prototype.settling=function(){return{}},c.prototype.accept=function(c){return this.settle()[a(c)]=b(c),!0},this.newPond=function(){return new c}}function J(a,b){function c(){}c.prototype=new G,c.prototype.settling=function(){return a},c.prototype.accept=function(a){var c=b(this.settle(),a);return void 0!==c&&this.settle(c),!0},this.newPond=function(){return new c}}function K(a){function c(){}c.prototype=new b,c.prototype.accept=function(b){return a(b,this.index++),!0},c.prototype.get=function(){},this.newPond=function(){return new c}}function L(a){function b(){}b.prototype=new G,b.prototype.settling=function(){return Y},b.prototype.accept=function(b){return this.settle()!==Y?this.settle(a(this.settle(),b)):this.settle(b),!0},b.prototype.get=function(){return this.settle()!==Y?N.Some(this.settle()):N.None()},this.newPond=function(){return new b}}function M(a){function b(){}b.prototype=new G,b.prototype.settling=function(){return[]},b.prototype.accept=function(b){return this.settle().length<a&&(this.settle().push(b),!0)},this.newPond=function(){return new b}}function N(){var a=this,b=null,c=null,d=null,e=function(b){for(var c=a;null!=c&&null!=c.operator();c=c.upstream()){var d=c.operator().newPond();d.downstream=b,b=d}return b},f=function(a,b){a.begin();for(var c=b.iterator();c.hasNext()&&a.accept(c.next()););c.close(),a.done()},g=function(){for(var b=a,c=a;null!=b&&null!=c.upstream()&&(b=b.upstream(),null!=(c=c.upstream().upstream()));)if(b==c)return!1;return!0};this.upstream=function(){return arguments.length>0?(b=arguments[0],a):b},this.operator=function(){return arguments.length>0?(c=arguments[0],a):c},this.add=function(b){if(null!=b)return(new N).operator(b).upstream(a).source(this.source());throw new Error("Intermediate Operator Should Not Be null.")},this.source=function(){return arguments.length>0?(d=arguments[0],a):d},this.converge=function(a,b){if(null!=a){if(null!=(b=null!=b?b:this.source())){if(g())return f(e(a),b),a;throw new Error("Loop Dependency Was Detected.")}throw new Error("Data Source Was Not Specified.")}throw new Error("Downstream Pond Was Not Specified.")},this.evaluate=function(a){if(null!=a)return this.converge(a.newPond(),arguments[1]).get();throw new Error("Terminate Operator Was Not Specified.")},this.cartesian=function(a){return this.add(new i(a))},this.distinct=function(){return this.add(new l(arguments[0]))},this.filter=function(a){return this.add(new m(a))},this.flatMap=function(a){return this.add(new n(a))},this.groupBy=function(a){var b=arguments.length>1?arguments[1]:function(a){return a};return this.add(new q(a,b))},this.intersection=function(a){return this.distinct(arguments[1]).add(new r(a.distinct(arguments[1]),arguments[1]))},this.keyBy=function(a){return this.map(function(b,c){return[a(b,c),b]})},this.limit=function(a){return this.filter(function(b,c){return c<a})},this.map=function(a){return this.add(new u(a))},this.peek=function(a){return this.add(new x(a))},this.reverse=function(){return this.add(new y)},this.skip=function(a){return this.add(new A(a))},this.sortBy=function(){var a=arguments.length>0&&da(arguments[0])?arguments[0]:arguments;return this.sortWith(ga(a),!0)},this.sortWith=function(){return this.add(new B(arguments[0],arguments[1]))},this.stratifyBy=function(){var a=arguments.length>0&&da(arguments[0])?arguments[0]:arguments;return this.stratifyWith(ga(a),!0)},this.stratifyWith=function(){return this.add(new C(arguments[0],arguments[1]))},this.subtract=function(a){return this.add(new D(a.distinct(arguments[1]),arguments[1]))},this.union=function(a){return this.add(new E(a))},this.zip=function(a){return this.map(function(a,b){return[b,a]}).join(a.map(function(a,b){return[b,a]})).mapJoint(function(a,b){return[a,b]})},this.cogroup=function(){for(var a=[],b=0;b<arguments.length;b++)a.push(arguments[b]);return this.add(new k(a))},this.foldByKey=function(a,b){return this.groupByKey(arguments[2],arguments[3]).mapValues(function(c,d){return N.of(c).fold(a(d),b)})},this.fullJoin=function(a){return this.add(new p(a,arguments[1],arguments[2],arguments[3],arguments[4]))},this.groupByKey=function(){return this.add(new q(arguments[0],arguments[1]))},this.having=function(a){var b=null!=arguments[1]?arguments[1]:_,c=null!=arguments[2]?arguments[2]:$;return this.filter(function(d){return a(b(d),c(d))})},this.join=function(a){return this.add(new s(a,arguments[1],arguments[2],arguments[3],arguments[4]))},this.keys=function(){return this.map(null!=arguments[0]?arguments[0]:$)},this.leftJoin=function(a){return this.add(new t(a,arguments[1],arguments[2],arguments[3],arguments[4]))},this.mapJoint=function(a){return this.add(new v(a))},this.mapValues=function(a){return this.add(new w(a,arguments[1],arguments[2]))},this.reduceByKey=function(a){return this.groupByKey(arguments[1],arguments[2]).mapValues(function(b,c){return N.of(b).reduce(a).get()})},this.rightJoin=function(a){return this.add(new z(a,arguments[1],arguments[2],arguments[3],arguments[4]))},this.values=function(){return this.map(null!=arguments[0]?arguments[0]:_)},this.choose=function(a){return this.add(new j(a))},this.flatten=function(){return this.add(new o(arguments[0]))},this.unpack=function(a){return this.add(new F(a))},this.select=function(){if(arguments.length>0){var a=arguments[0],b=null;if(ca(a))b=a;else{b={};for(var c=da(a)?a:arguments,d=null,e=0;e<c.length;e++)d=c[e],"string"==typeof d?b[d]=d:"function"==typeof d&&null!=d.alias&&(b[d.alias]=d)}var f={};for(var g in b)b.hasOwnProperty(g)&&(f[g]=N.field(b[g],g));return this.map(function(a){var b={};for(var c in f)f.hasOwnProperty(c)&&(b[c]=f[c](a));return b})}return this.map(function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b})},this.window=function(){for(var a=this,b=0;b<arguments.length;b++){var c=arguments[b],d=c.aggr,e=c.updt,f=c.expr,g=c.alias,h=c.part,i=c.order,j=c.scope,k=c.byRows;h=null!=h&&h.length>0&&da(h[0])?h[0]:h,i=null!=i&&i.length>0&&da(i[0])?i[0]:i,j=null!=j&&j.length>0&&da(j[0])?j[0]:j,a=ja(a,d,e,f,g,h,i,j,k)}return a},this.collect=function(){return this.evaluate(new H)},this.count=function(){return this.map(function(a){return 1}).fold(0,function(a,b){return a+b})},this.countByValue=function(){var a=arguments.length>0?arguments[0]:function(a){return a};return this.map(function(b){return[a(b),1]}).groupByKey().mapValues(function(a){return N.of(a).fold(0,function(a,b){return a+b})}).collectAsMap()},this.first=function(){var a=arguments[0],b=this;void 0!==a&&(b=b.filter(a));var c=b.take(1);return c.length>0?N.Some(c[0]):N.None()},this.fold=function(a,b){return this.evaluate(new J(a,b))},this.foreach=function(a){this.evaluate(new K(a))},this.reduce=function(a){return this.evaluate(new L(a))},this.take=function(a){return this.evaluate(new M(a))},this.collectAsMap=function(){return this.evaluate(new I(arguments[0],arguments[1]))},this.countByKey=function(){return this.mapValues(function(){return 1}).foldByKey(function(){return 0},function(a,b){return a+b},arguments[0]).collectAsMap()}}function O(){}function P(){}function Q(a,b,c){function d(a,b,c){this.array=a,this.index=b,this.end=c}b=Math.max(null==b?0:b,0),c=Math.min(null==c?a.length:c,a.length),d.prototype=new O,d.prototype.close=function(){this.array=null,this.index=null,this.end=null},d.prototype.hasNext=function(){return this.index<this.end},d.prototype.next=function(){return this.array[this.index++]},this.iterator=function(){return new d(a,b,c)}}function R(a,b){function c(){this.index=0,this.value=void 0}c.prototype=new O,c.prototype.close=function(){"function"==typeof b&&b(this.index-1),this.index=null,this.value=null},c.prototype.hasNext=function(){return this.value=a(this.index++),this.value!==Y},c.prototype.next=function(){return this.value},this.iterator=function(){return new c}}function S(){}function T(a){this.get=function(){return a},this.source(new Q([a]))}function U(){this.source(new Q(X))}function V(){this.aggr=null,this.updt=null,this.expr=null,this.alias=null,this.part=null,this.order=null,this.byRows=null,this.scope=null}var W="object"==typeof global&&global||this,X=[],Y={},Z=function(a){return a},$=function(a){return a[0]},_=function(a){return a[1]},aa=function(a,b){return a<b?-1:a>b?1:0},ba=function(a,b){return a===b?0:aa(a,b)},ca=function(a){return null!=a&&a.constructor==Object},da=function(a){return null!=a&&a.constructor==Array},ea=function(a,b,c){null==c&&(c=[]);for(var d=null,e=0;e<a.length;e++)d=a[e],(b>0||null==b)&&d instanceof Array?ea(d,null==b?null:b-1,c):c.push(d);return c},fa=function(a,b,c){for(var d=null,e=0;e<c.length;e++){var f=c[e];"boolean"==typeof f?d=f:"function"==typeof f&&(a.push(f),null!=d&&b.push(d),d=!0)}null!=d&&b.push(d)},ga=function(a){if(null!=a){var b=[],c=[];return fa(b,c,a),function(a,d){for(var e=0,f=0;f<b.length;f++){var g=b[f];if(0!=(e=aa(g(a),g(d)))){c[f]||(e*=-1);break}}return e}}return null},ha=function(a,b,c){if(null!=b){a.sort(b);var d=null,e=null,f=null,g=[];if(c)for(var h=0;h<a.length;h++)e=a[h],null!=f&&0==b(d,e)||(f=[],g.push(f)),f.push(e),d=e;else for(var h=a.length-1;h>=0;h--)e=a[h],null!=f&&0==b(d,e)||(f=[],g.push(f)),f.push(e),d=e;return g}return[a]},ia=function(a,b,c,d,e,f,g){if(0==d)return c;for(var h=d>0,i=a.length,j=null,k=null,l=c;h&&l<i||!h&&l>=0;l+=d)if(k=b(a[l]),e){if(!f(k,g))break;j=l}else if(f(k,g)){j=l;break}return j},ja=function(a,b,c,d,e,f,g,h,i){b=null!=b?b:function(){},c=null!=c?c:function(a){return a},d=null!=d?d:function(a,b){return b};var j=null,k=null;null!=h?(j=h[0],k=h[1],i=null==i||i):i=null;var l=!0,m=!1,n=function(a,b){return a<=b},o=function(a,b){return a>=b},p=[],q=[],r=null,s=null;null!=g&&g.length>0&&(fa(p,q,g),r=p[0],s=q[0]);var t=function(a,b,c){var d=a<0?-1:1,e=a<0?l:m,f=c?o:n;return function(a,g,h,i,j){var k=null;if(null==h)k=0;else if(0==h)k=i;else{var l=h<0?i:j-1,m=g+(c?1:-1)*h;k=ia(a,b,l,d,e,f,m)}return k}},u=function(a,b,c){var d=a>0?1:-1,e=a>0?l:m,f=c?n:o;return function(a,g,h,i,j){var k=null;if(null==h)k=a.length-1;else if(0==h)k=j-1;else{var l=h>0?j-1:i,m=g+(c?1:-1)*h;k=ia(a,b,l,d,e,f,m)}return null!=k&&k++,k}},v=null;return null!=h&&(v=i?[function(a,b,c,d,e){return Math.max(null==c?0:b+c,0)},function(a,b,c,d,e){return Math.min(null==c?a.length:b+c+1,a.length)}]:[t(j,r,s),u(k,r,s)]),a.stratifyBy.apply(a,f).flatMap(function(a){for(var f=N.of(a),l=f.stratifyBy.apply(f,g).collect(),m=b(l),n=[],o=[],p=null,q=void 0,s=null,t=null,u=0;u<l.length;u++)if(p=l[u],o.push(p.length),t=n.length,n.push.apply(n,p),null==h){s=n.length,q=c(m,n,0,s,s-p.length,s);for(var w=0;w<p.length;w++)p[w][e]=d(t+w,q,n,0,s,s-p.length,s)}if(l=null,null!=h){var x=null,y=null;if(s=n.length,i)for(var z=0,A=0,B=0;B<o.length;B++){A+=o[B];for(var C=z;C<A;C++)x=v[0](n,C,j,z,A),y=v[1](n,C,k,z,A),q=c(m,n,x,y,z,A),n[C][e]=d(C,q,n,x,y,z,A);z=A}else for(var z=0,A=0,D=void 0,B=0;B<o.length;B++){A+=o[B],D=r(n[z]),x=v[0](n,D,j,z,A),y=v[1](n,D,k,z,A),q=null!=x&&null!=y?c(m,n,x,y,z,A):void 0;for(var C=z;C<A;C++)n[C][e]=d(C,q,n,x,y,z,A);z=A}}return n})};a.prototype.begin=function(){null!=this.downstream&&this.downstream.begin()},a.prototype.accept=function(a){},a.prototype.done=function(){null!=this.downstream&&this.downstream.done()},b.prototype=new a,b.prototype.begin=function(){void 0===this.index&&(this.index=0),null!=this.downstream&&this.downstream.begin()},c.prototype=new a,c.prototype.settling=null,c.prototype.begin=function(){void 0===this.settle()&&null!=this.settling&&this.settle(this.settling()),null!=this.downstream&&this.downstream.begin()},c.prototype.settle=function(){return arguments.length>0?(this.sediment=arguments[0],this):this.sediment},d.prototype=new c,d.prototype.settling=function(){return[]},d.prototype.accept=function(a){return this.settle().push(a),!0},e.prototype=new c,e.prototype.settling=function(){return{}},e.prototype.keyOf=$,e.prototype.valOf=_,e.prototype.accept=function(a){var b=this.keyOf(a),c=this.settle(),d=c[b];return null==d&&(d=[],c[b]=d),d.push(this.valOf(a)),!0},e.prototype.done=function(){if(null!=this.downstream){var a=this.settle();for(var b in a)if(a.hasOwnProperty(b)&&!this.downstream.accept([b,a[b]]))break;this.downstream.done()}},f.prototype=new a,f.prototype.that=function(){},f.prototype.begin=function(){void 0===this.branch&&(this.branch=this.that().collect()),null!=this.downstream&&this.downstream.begin()},g.prototype=new e,g.prototype.that=function(){},g.prototype.base=function(a,b){},g.prototype.join=function(a,b,c,d){return!1},g.prototype.done=function(){if(null!=this.downstream){var a=this.settle(),b=this.that().groupByKey(this.keyR,this.valR).collectAsMap(),c=this.base(a,b),d=this.downstream;for(var e in c)if(c.hasOwnProperty(e)&&!this.join(d,e,a[e],b[e]))break;d.done()}},h.prototype.newPond=function(){return new a},i.prototype=new h,j.prototype=new h,k.prototype=new h,l.prototype=new h,m.prototype=new h,n.prototype=new h,o.prototype=new h,p.prototype=new h,q.prototype=new h,r.prototype=new h,s.prototype=new h,t.prototype=new h,u.prototype=new h,v.prototype=new h,w.prototype=new h,x.prototype=new h,y.prototype=new h,z.prototype=new h,A.prototype=new h,B.prototype=new h,C.prototype=new h,D.prototype=new h,E.prototype=new h,F.prototype=new h,G.prototype=new c,G.prototype.get=function(){return this.settle()},H.prototype=new h,I.prototype=new h,J.prototype=new h,K.prototype=new h,L.prototype=new h,M.prototype=new h,N.eod=function(){return Y},N.mapOfPairs=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d[0]]=d[1]}return b},N.pairsOfMap=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push([c,a[c]]);return b},O.prototype.close=function(){},O.prototype.hasNext=function(){},O.prototype.next=function(){},P.prototype.iterator=function(){},Q.prototype=new P,R.prototype=new P,N.of=function(a){return a instanceof Array?(new N).source(new Q(a,arguments[1],arguments[2])):"function"==typeof a?(new N).source(new R(a,arguments[1])):N.of(N.pairsOfMap(a))},S.prototype=new N,S.prototype.get=function(){},S.prototype.or=function(a){},S.prototype.orNull=function(){},S.prototype.given=function(){},T.prototype=new S,T.prototype.or=function(a){return this.get()},T.prototype.orNull=function(){return this.get()},T.prototype.given=function(){return!0},U.prototype=new S,U.prototype.or=function(a){return a},U.prototype.orNull=function(){return null},U.prototype.given=function(){return!1},N.Some=function(a){return new T(a)},N.None=function(){return new U},N.wrapPicker=function(a){var b=a;if(null==a)b=function(){return null};else if("function"!=typeof a){var c=a.toString();b=function(a){return a[c]}}return b},N.field=function(a,b){return null==b&&null!=a&&(b="function"!=typeof a?a.toString():a.alias),a=N.wrapPicker(a),a.alias=b,a},V.prototype.aggregator=function(){return arguments.length>0?(this.aggr=arguments[0],this):this.aggr},V.prototype.updater=function(){return arguments.length>0?(this.updt=arguments[0],this):this.updt},V.prototype.expressor=function(){return arguments.length>0?(this.expr=arguments[0],this):this.expr},V.prototype.as=function(){return arguments.length>0?(this.alias=arguments[0],this):this.alias},V.prototype.partBy=function(){return arguments.length>0?(this.part=arguments,this):this.part},V.prototype.orderBy=function(){return arguments.length>0?(this.order=arguments,this):this.order},V.prototype.rows=function(){return this.byRows=!0,this},V.prototype.range=function(){return this.byRows=!1,this},V.prototype.between=function(){return arguments.length>1?(this.scope=[arguments[0],arguments[1]],this):1==arguments.length?(this.scope=arguments[0],this):this.scope},N.item=function(a){var b=new V;return"function"==typeof a?b.updater(a):null!=a&&(b.aggregator(a.aggr),b.updater(a.updt),b.expressor(a.expr)),b},N.wf={count:function(a){var b=arguments.length>1&&!0===arguments[1],c=null;return b&&(c=arguments[2]),N.item(function(d,e,f,g){var h=N.of(e,f,g).map(a);return b&&(h=h.distinct(c)),h.count()})},cume_dist:function(){return N.item({aggr:function(a){return N.of(a).flatMap(function(a){return a}).count()},updt:function(a,b,c,d){return b.length/a}})},dense_rank:function(){return N.item({aggr:function(a){return N.of(a).flatMap(function(a,b){return N.of(a).map(function(a,c){return b+1}).collect()}).map(function(a,b){return[b,a]}).sortBy(function(a){return a[0]}).map(function(a){return a[1]}).collect()},expr:function(a,b){return b[a]}})},fold:function(a,b){var c=null!=arguments[2]?arguments[2]:function(a){return a};return N.item(function(d,e,f,g){return N.of(e,f,g).map(c).fold(a(),b)})},lag:function(a){var b=Math.max(arguments.length>1?arguments[1]:1,0),c=arguments.length>2?arguments[2]:void 0;return N.item({expr:function(d,e,f){return d-b<0?c:a(f[d-b])}})},lead:function(a){var b=Math.max(arguments.length>1?arguments[1]:1,0),c=arguments.length>2?arguments[2]:void 0;return N.item({aggr:function(a){return N.of(a).flatMap(function(a){return a}).collect()},expr:function(d,e){return d+b>=e.length?c:a(e[d+b])}})},max:function(a){var b=arguments.length>1?arguments[1]:aa;return N.item(function(c,d,e,f){return N.of(d,e,f).map(a).reduce(function(a,c){return b(a,c)<0?c:a}).get()})},min:function(a){var b=arguments.length>1?arguments[1]:aa;return N.item(function(c,d,e,f){return N.of(d,e,f).map(a).reduce(function(a,c){return b(a,c)>0?c:a}).get()})},ntile:function(a){return a=Math.max(a,1),N.item({aggr:function(b){for(var c=N.of(b).flatMap(function(a){return a}),d=c.count(),e=Math.max(Math.floor(d/a),1),f=d<=a?0:d%a,g=[],h=1;h<=a;h++){for(var i=0;i<e;i++)g.push(h);h<=f&&g.push(h)}return g},expr:function(a,b){return b[a]}})},percent_rank:function(){return N.item({aggr:function(a){var b=a.length-1;return N.of(a).flatMap(function(a,b){return N.of(a).map(function(a,c){return b}).collect()}).map(function(a,b){return[b,a]}).sortBy(function(a){return a[0]}).map(function(a){return 0==b?0:a[1]/b}).collect()},expr:function(a,b){return b[a]}})},rank:function(){return N.item({aggr:function(a){return N.of(a).flatMap(function(a,b){return N.of(a).map(function(a,c){return b}).collect()}).map(function(a,b){return[a,b+1]}).groupByKey().map(function(a){return a[1]}).flatMap(function(a){var b=N.of(a).reduce(function(a,b){return Math.min(a,b)}).get();return N.of(a).map(function(a){return[a,b]}).collect()}).sortBy(function(a){return a[0]}).map(function(a){return a[1]}).collect()},expr:function(a,b){return b[a]}})},row_number:function(){return N.item({expr:function(a){return a+1}})},sum:function(a){return N.item(function(b,c,d,e){return N.of(c,d,e).map(a).reduce(function(a,b){return a+b}).get()})}},N.on=function(a){var b=arguments.length>1?arguments[1]:"canal";a.prototype[b]=function(){for(var a=[this],b=0;b<arguments.length;b++)a.push(arguments[b]);return N.of.apply(this,a)}},N.off=function(a){var b=arguments.length>1?arguments[1]:"canal";delete a.prototype[b]},N.unit=Z,N.kop=$,N.vop=_,"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=N:exports=N:W.Canal=N}).call(this);